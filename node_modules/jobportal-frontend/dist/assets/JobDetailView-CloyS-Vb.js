import{_ as H,m as U,p as _,r as q,q as B,s as O,i as X,x as $,c as n,a as e,b as m,w as r,B as x,t as s,g as V,h as K,F as v,d as b,v as Y,u as G,o as i,e as p,k as A,n as N,y as Q}from"./index-BsLnnuA8.js";import{B as j}from"./BaseCard-BhYAbX2i.js";import{u as W}from"./jobsStore-C7FdPDiM.js";const Z={key:0,class:"job-detail"},ee={class:"job-detail__header"},te={class:"job-detail__badge"},ae={class:"job-detail__layout"},se={class:"job-detail__content"},le={class:"job-detail__company"},oe={class:"job-detail__salary"},ne={class:"job-detail__meta"},ie={class:"job-detail__section"},re={class:"job-detail__section"},ue={class:"job-detail__section"},de={class:"job-detail__skills"},ce={class:"job-detail__apply"},me={key:0,class:"job-detail__status job-detail__status--error"},pe={key:1,class:"job-detail__status"},_e={class:"job-detail__sidebar"},ve={class:"job-detail__company-info"},be={class:"job-detail__facts"},ge={class:"job-detail__ratings"},ye={class:"job-detail__rating-score"},he={class:"job-detail__stars"},fe={class:"job-detail__comments"},je={class:"job-detail__review-form"},ke=["value"],we={class:"job-detail__review-list"},Se={class:"review-card__header"},xe={class:"review-card__rating"},De={key:1,class:"job-detail job-detail--empty"},Re={__name:"JobDetailView",setup(qe){const z="http://localhost:5000/api",k=$(),w=G(),S=W(),g=U(),C=["OKRs","Figma","Notion","User interviews"],I=["Disponibilidad para colaborar 15 horas semanales en ciclos ágiles.","Documentar hallazgos en Notion y presentar recap semanal.","Nivel conversacional de inglés para syncs con mentores globales."],D=[{id:"r-1",author:"Majo · Diseñadora",rating:5,comment:"Proceso súper humano, recibí feedback accionable en cada sprint.",date:"2025-08-10"},{id:"r-2",author:"Ricardo · Data",rating:4,comment:"La empresa está iterando rápido, hay espacio para proponer.",date:"2025-08-02"}],l=_(()=>S.selectedJob),J=_(()=>{var o,t;return(t=(o=l.value)==null?void 0:o.requirements)!=null&&t.length?l.value.requirements:I}),f=_(()=>{var o,t,a,h;return{summary:((o=l.value)==null?void 0:o.companySummary)||"Startup enfocada en crear experiencias data-informed para escalar productos con cohorts universitarios.",size:((t=l.value)==null?void 0:t.companySize)||"50 - 80 personas",hq:((a=l.value)==null?void 0:a.companyHq)||"CDMX · Remote first",industry:((h=l.value)==null?void 0:h.industry)||"Producto digital"}}),u=q({loading:!1,error:"",success:!1}),y=B(!1),d=B([...D]),c=q({rating:5,comment:""});O(l,o=>{var t;o&&(y.value=!!o.alreadyApplied,d.value=(t=o.reviews)!=null&&t.length?o.reviews:[...D])});const R=_(()=>d.value.length?d.value.reduce((t,a)=>t+Number(a.rating||0),0)/d.value.length:0),P=_(()=>R.value.toFixed(1)),F=_(()=>d.value.length),M=async()=>{var o,t;if(!g.isAuthenticated){w.push({name:"login",query:{redirect:k.fullPath}});return}if(!(!l.value||y.value||u.loading)){u.loading=!0,u.error="";try{await Q.post(`${z}/applications`,{jobId:l.value.id||l.value._id},{headers:g.token?{Authorization:`Bearer ${g.token}`}:void 0}),y.value=!0,u.success=!0}catch(a){u.error=((t=(o=a.response)==null?void 0:o.data)==null?void 0:t.message)||"No pudimos registrar tu postulación"}finally{u.loading=!1}}},T=()=>{var o;if(!g.isAuthenticated){w.push({name:"login",query:{redirect:k.fullPath}});return}c.comment.trim()&&(d.value=[{id:Date.now().toString(),author:((o=g.user)==null?void 0:o.name)||"Talento JobPortal",rating:c.rating,comment:c.comment.trim(),date:new Date().toISOString()},...d.value],c.comment="")},L=o=>o?new Date(o).toLocaleDateString("es-MX",{month:"short",day:"numeric"}):"Reciente",E=()=>{w.back()};return X(async()=>{await S.fetchJobs(),S.fetchJobById(k.params.id)}),(o,t)=>l.value?(i(),n("section",Z,[e("div",ee,[m(x,{variant:"ghost",size:"sm",onClick:E},{default:r(()=>[...t[2]||(t[2]=[p("← Volver",-1)])]),_:1}),e("span",te,s(l.value.modality||"Flexible"),1)]),e("div",ae,[e("article",se,[m(j,{variant:"glass"},{title:r(()=>[p(s(l.value.title),1)]),default:r(()=>[e("p",le,s(l.value.company)+" · "+s(l.value.location),1),e("p",oe,s(l.value.salaryRange||l.value.salary),1),e("div",ne,[e("div",null,[t[3]||(t[3]=e("small",null,"Nivel",-1)),e("strong",null,s(l.value.seniority||"Intermedio"),1)]),e("div",null,[t[4]||(t[4]=e("small",null,"Publicado",-1)),e("strong",null,s(l.value.postedAgo||"Hoy"),1)]),e("div",null,[t[5]||(t[5]=e("small",null,"Horario",-1)),e("strong",null,s(l.value.schedule||"Tiempo completo"),1)])]),e("section",ie,[t[6]||(t[6]=e("h3",null,"Descripción",-1)),e("p",null,s(l.value.description||"Experimenta con desafíos reales: iteraciones con stakeholders, research vivo y acceso a frameworks exclusivos."),1)]),e("section",re,[t[7]||(t[7]=e("h3",null,"Requerimientos",-1)),e("ul",null,[(i(!0),n(v,null,b(J.value,a=>(i(),n("li",{key:a},s(a),1))),128))])]),e("section",ue,[t[8]||(t[8]=e("h3",null,"Skills",-1)),e("ul",de,[(i(!0),n(v,null,b(l.value.skills||C,a=>(i(),n("li",{key:a},s(a),1))),128))])]),e("div",ce,[m(x,{size:"lg","is-loading":u.loading,disabled:y.value,onClick:M},{default:r(()=>[p(s(y.value?"Ya postulaste":"Aplicar ahora"),1)]),_:1},8,["is-loading","disabled"]),u.error?(i(),n("p",me,s(u.error),1)):A("",!0),u.success?(i(),n("p",pe,"¡Listo! Tu perfil fue enviado.")):A("",!0)])]),_:1})]),e("aside",_e,[m(j,null,{title:r(()=>[...t[9]||(t[9]=[p("Sobre la empresa",-1)])]),default:r(()=>[e("p",ve,s(f.value.summary),1),e("ul",be,[e("li",null,[t[10]||(t[10]=e("span",null,"Equipo",-1)),e("strong",null,s(f.value.size),1)]),e("li",null,[t[11]||(t[11]=e("span",null,"Headquarters",-1)),e("strong",null,s(f.value.hq),1)]),e("li",null,[t[12]||(t[12]=e("span",null,"Industria",-1)),e("strong",null,s(f.value.industry),1)])])]),_:1}),m(j,null,{title:r(()=>[...t[13]||(t[13]=[p("Valoraciones",-1)])]),default:r(()=>[e("div",ge,[e("div",null,[e("p",ye,s(P.value),1),e("small",null,s(F.value)+" reseñas",1)]),e("div",he,[(i(),n(v,null,b(5,a=>e("span",{key:a,class:N(["star",{"star--active":a<=Math.round(R.value)}])},null,2)),64))])])]),_:1})])]),e("section",fe,[e("header",null,[t[16]||(t[16]=e("div",null,[e("p",{class:"section-kicker"},"Feedback de cohorts"),e("h3",null,"Lo que dice la comunidad.")],-1)),e("div",je,[e("label",null,[t[14]||(t[14]=e("span",null,"Valoración",-1)),V(e("select",{"onUpdate:modelValue":t[0]||(t[0]=a=>c.rating=a)},[(i(),n(v,null,b([5,4,3,2,1],a=>e("option",{key:a,value:a},s(a)+" / 5",9,ke)),64))],512),[[K,c.rating,void 0,{number:!0}]])]),V(e("textarea",{"onUpdate:modelValue":t[1]||(t[1]=a=>c.comment=a),placeholder:"Comparte tu experiencia con este equipo",rows:"3"},null,512),[[Y,c.comment]]),m(x,{size:"sm",onClick:T},{default:r(()=>[...t[15]||(t[15]=[p("Publicar",-1)])]),_:1})])]),e("ul",we,[(i(!0),n(v,null,b(d.value,a=>(i(),n("li",{key:a.id,class:"review-card"},[e("div",Se,[e("strong",null,s(a.author),1),e("span",null,s(L(a.date)),1)]),e("div",xe,[(i(),n(v,null,b(5,h=>e("span",{key:h,class:N(["star",{"star--active":h<=a.rating}])},null,2)),64)),e("small",null,s(a.rating)+"/5",1)]),e("p",null,s(a.comment),1)]))),128))])])])):(i(),n("section",De,[m(j,null,{title:r(()=>[...t[17]||(t[17]=[p("Selecciona una vacante",-1)])]),default:r(()=>[t[18]||(t[18]=e("p",null,"Explora el radar y elige un rol para ver los detalles.",-1))]),_:1})]))}},Ne=H(Re,[["__scopeId","data-v-fc575971"]]);export{Ne as default};
