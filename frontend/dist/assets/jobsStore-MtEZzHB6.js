import{D as u,z as o}from"./index-Cw7ty9o7.js";const h={"full-time":"Tiempo completo","part-time":"Medio tiempo",contract:"Contrato",internship:"Internship",temporary:"Temporal"},y={submitted:"Enviada","in-review":"En revisión",interview:"Entrevista",offer:"Oferta",rejected:"Rechazada"},f=(t="USD")=>new Intl.NumberFormat("es-MX",{style:"currency",currency:t,maximumFractionDigits:0}),p=t=>{if(!(t!=null&&t.min)&&!(t!=null&&t.max))return"Salario a convenir";const e=f(t.currency||"USD");return t.min&&t.max?`${e.format(t.min)} - ${e.format(t.max)} ${t.currency||"USD"}`:t.min?`${e.format(t.min)} ${t.currency||"USD"}`:t.max?`${e.format(t.max)} ${t.currency||"USD"}`:"Salario a convenir"},b=t=>{if(!t)return"Reciente";const e=new Date(t);if(Number.isNaN(e.getTime()))return"Reciente";const s=Math.round((Date.now()-e.getTime())/(1e3*60*60*24));return s<=0?"Hoy":s===1?"Hace 1 día":`Hace ${s} días`},n=t=>{var e,s,r,a,i;return{id:t._id,title:t.title,company:((e=t.company)==null?void 0:e.name)||"Compañía confidencial",companyId:((s=t.company)==null?void 0:s._id)||t.company,location:t.location||"Remoto · LATAM",salaryRange:p(t.salaryRange),contractType:t.contractType,modality:h[t.contractType]||"Flexible",skills:t.skills||[],description:t.description,requirements:t.requiredExperience?[t.requiredExperience]:[],industry:(r=t.company)==null?void 0:r.industry,companySummary:(a=t.company)==null?void 0:a.description,companyHq:(i=t.company)==null?void 0:i.location,publishedAt:t.publishedAt||t.createdAt,postedAgo:b(t.publishedAt||t.createdAt),status:t.status,applicationsCount:Number(t.applicationsCount)||0,raw:t}},A=t=>{var e,s,r,a,i,c,l,m,d;return{id:t._id,jobId:((e=t.job)==null?void 0:e._id)||t.job,role:((s=t.job)==null?void 0:s.title)||"Rol confidencial",candidate:((r=t.candidate)==null?void 0:r.name)||"Talento anónimo",candidateEmail:(a=t.candidate)==null?void 0:a.email,status:t.status,statusLabel:y[t.status]||t.status,submittedAt:t.appliedAt||t.createdAt,message:t.message,jobCompany:((c=(i=t.job)==null?void 0:i.company)==null?void 0:c.name)||((l=t.job)==null?void 0:l.company),cvUrl:((m=t.cv)==null?void 0:m.url)||null,cvOriginalName:((d=t.cv)==null?void 0:d.originalName)||null,raw:t}},T=u("jobs",{state:()=>({jobs:[],selectedJob:null,filters:{query:"",location:"",modality:""},applications:[],loading:!1,saving:!1,error:""}),actions:{async fetchJobs(t={}){this.loading=!0,this.error="";try{const e=await o("/jobs",{params:{status:"active",...t}});this.jobs=Array.isArray(e)?e.map(n):[]}catch(e){this.error=e.message,this.jobs=[]}finally{this.loading=!1}},async fetchJobById(t){if(!t){this.selectedJob=null;return}this.loading=!0,this.error="";try{const e=await o(`/jobs/${t}`);this.selectedJob=n(e)}catch(e){this.error=e.message,this.selectedJob=null}finally{this.loading=!1}},async fetchApplications(t={}){this.loading=!0,this.error="";try{const e=await o("/applications",{params:t,auth:!0});Array.isArray(e)&&(this.applications=e.map(A))}catch(e){this.applications=[],this.error=e.message}finally{this.loading=!1}},setFilters(t){this.filters={...this.filters,...t}},async createJob(t){this.saving=!0,this.error="";try{const e=await o("/jobs",{method:"POST",data:t,auth:!0}),s=n(e);return this.jobs=[s,...this.jobs],s}catch(e){throw this.error=e.message,e}finally{this.saving=!1}},async updateJob(t,e){var s;if(t){this.saving=!0,this.error="";try{const r=await o(`/jobs/${t}`,{method:"PATCH",data:e,auth:!0}),a=n(r);this.jobs=this.jobs.map(i=>i.id===t?a:i),((s=this.selectedJob)==null?void 0:s.id)===t&&(this.selectedJob=a)}catch(r){throw this.error=r.message,r}finally{this.saving=!1}}},async deleteJob(t){var e;if(t){this.saving=!0,this.error="";try{await o(`/jobs/${t}`,{method:"DELETE",auth:!0}),this.jobs=this.jobs.filter(s=>s.id!==t),((e=this.selectedJob)==null?void 0:e.id)===t&&(this.selectedJob=null)}catch(s){throw this.error=s.message,s}finally{this.saving=!1}}}}});export{T as u};
