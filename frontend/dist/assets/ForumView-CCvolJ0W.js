import{_ as le,p as ae,s as f,r as G,c as y,x as P,o as re,a,b as e,m as h,d as S,w as L,B as q,F as d,e as p,j as T,k as I,t as l,l as B,i as H,v as O,u as ne,g as r,h as j,n as J}from"./index-Cw7ty9o7.js";import{B as Q}from"./BaseInput-DF9V6cTV.js";import{u as ie}from"./forumStore-B1Zqy042.js";const ue={class:"forum"},ce={class:"forum__hero"},de={class:"hero__content"},pe={class:"hero__actions"},me={class:"hero__stats"},_e={class:"hero__snapshot"},ve={class:"forum__controls"},fe={class:"controls__grid"},ye={class:"filters__chips"},he=["onClick"],be={class:"filters__chips filters__chips--soft"},ge=["onClick"],ke={class:"controls__sort"},Ce={class:"controls__hint"},Se={key:0,class:"controls__error"},Te={class:"forum__layout"},Me={class:"forum__threads"},we={key:0,class:"thread-card thread-card--loading"},Ve={key:1,class:"thread-card thread-card--empty"},xe={class:"thread-card__header"},Ee={class:"thread-card__category"},Ae={class:"thread-card__status"},Be={key:0,class:"thread-card__focus"},Ne={class:"thread-card__footer"},Ue={class:"thread-card__comments"},De={key:0,class:"comments__list"},Fe={key:1,class:"comments__empty"},Le=["onSubmit"],qe=["onUpdate:modelValue"],Oe={class:"forum__sidebar"},je={key:0,class:"sidebar-card sidebar-card--spotlight"},Re={class:"sidebar-card__tags"},$e={class:"sidebar-card"},ze={class:"sidebar-card"},Ge={key:0,class:"forum-modal",role:"dialog","aria-modal":"true"},Pe={class:"forum-modal__panel"},Ie={class:"modal-field"},He=["value"],Je={class:"modal-field"},Qe={class:"modal-field"},Xe={key:0,class:"modal-field__error"},Ke={__name:"ForumView",setup(We){const m=ie(),b=ae(),X=ne(),M=["General","Producto","Diseño","Tech","Growth"],R=["Todos","Nuevo","Con actividad"],g={titleMin:5,contentMin:30,categoryMin:3},_=f("Todos"),w=f(R[0]),V=f(""),N=f("recent"),U=f(!1),n=G({title:"",category:M[0],content:"",focus:""}),i=G({error:"",isSubmitting:!1}),x=f({}),D=y(()=>{const o=new Set(M);return m.threads.forEach(s=>{o.add(s.category||"General")}),["Todos",...o]}),E=y(()=>{const o=D.value.filter(s=>s!=="Todos");return o.length?o:["General"]});P(D,o=>{o.includes(_.value)||(_.value="Todos")}),P(E,o=>{o.length&&!o.includes(n.category)&&(n.category=o[0])},{immediate:!0});const K=["Comparte el entregable y la métrica a optimizar","¿Qué experimentos ya corriste y qué aprendiste?","Define qué tipo de feedback necesitás (UX, pitch, código)"],W=[{day:"Martes",title:"Clínica de portafolio async"},{day:"Jueves",title:"Ronda de entrevistas simuladas"},{day:"Sábado",title:"Demo day interno"}],Y=[{label:"Brief de la semana",value:"Onboarding remoto",description:"Optimizar en 3 iteraciones"},{label:"Snippets entregados",value:"26",description:"Listos para copiar y pegar"},{label:"Mentores live",value:"18+",description:"En sesiones esta semana"}],Z=y(()=>{let o=m.threads;if(_.value!=="Todos"&&(o=o.filter(s=>s.category===_.value)),w.value!=="Todos"&&(o=o.filter(s=>s.status===w.value)),V.value.trim()){const s=V.value.toLowerCase();o=o.filter(t=>{var u;return t.title.toLowerCase().includes(s)||t.author.toLowerCase().includes(s)||((u=t.preview)==null?void 0:u.toLowerCase().includes(s))})}return o}),A=y(()=>{const o=[...Z.value];return N.value==="active"?o.sort((s,t)=>t.replies-s.replies):o}),k=y(()=>A.value[0]||null),ee=y(()=>{const o=m.threads,s=o.reduce((t,u)=>t+u.replies,0);return[{label:"Hilos publicados",value:o.length||0},{label:"Respuestas esta semana",value:s||0},{label:"Mentores activos",value:"18+"}]}),te=()=>{F()&&(n.category||(n.category=E.value[0]||M[0]),i.error="",U.value=!0)},$=()=>{U.value=!1,i.error="",i.isSubmitting=!1},F=()=>b.isAuthenticated?!0:(X.push({name:"login",query:{redirect:"/forum"}}),!1),se=async()=>{var c,z;if(!F()||i.isSubmitting)return;i.error="";const o=n.title.trim(),s=n.content.trim(),t=(n.category||"").trim();if(t.length<g.categoryMin){i.error="Elegí una categoría válida para clasificar tu hilo.";return}if(o.length<g.titleMin){i.error=`El título necesita al menos ${g.titleMin} caracteres.`;return}if(s.length<g.contentMin){i.error=`El contexto necesita al menos ${g.contentMin} caracteres.`;return}const u=n.focus.split(",").map(C=>C.trim()).filter(Boolean),v=t||E.value[0]||M[0];i.isSubmitting=!0;try{await m.createThread({title:o,category:v,content:s,author:((c=b.user)==null?void 0:c._id)||((z=b.user)==null?void 0:z.id)},{focus:u}),n.title="",n.content="",n.focus="",n.category=v,$()}catch(C){i.error=(C==null?void 0:C.message)||"No pudimos publicar el hilo. Intentalo nuevamente."}finally{i.isSubmitting=!1}},oe=async o=>{var t,u;if(!F())return;const s=(x.value[o]||"").trim();if(s)try{await m.addComment(o,{author:((t=b.user)==null?void 0:t._id)||((u=b.user)==null?void 0:u.id),content:s}),x.value[o]=""}catch{}};return re(()=>{m.fetchThreads()}),(o,s)=>(r(),a("section",ue,[e("header",ce,[e("div",de,[s[9]||(s[9]=e("p",{class:"section-kicker"},"Conversaciones vivas",-1)),s[10]||(s[10]=e("h2",null,"Mentores y cohorts diseñan soluciones en tiempo real.",-1)),s[11]||(s[11]=e("p",null," Trae casos reales, retroalimentación accionable y recibe plantillas listas para iterar. Cada hilo captura decisiones, aprendizajes y métricas listas para compartir con tu squad. ",-1)),e("div",pe,[S(q,{type:"button",onClick:te},{default:L(()=>[...s[7]||(s[7]=[j("Crear nuevo hilo",-1)])]),_:1}),s[8]||(s[8]=e("button",{class:"hero__link",type:"button"},"Ver agenda de workshops",-1))]),e("ul",me,[(r(!0),a(d,null,p(ee.value,t=>(r(),a("li",{key:t.label},[e("span",null,l(t.value),1),e("small",null,l(t.label),1)]))),128))])]),e("div",_e,[(r(),a(d,null,p(Y,t=>e("article",{key:t.label,class:"snapshot-card"},[e("p",null,l(t.label),1),e("strong",null,l(t.value),1),e("small",null,l(t.description),1)])),64))])]),e("section",ve,[S(Q,{modelValue:V.value,"onUpdate:modelValue":s[0]||(s[0]=t=>V.value=t),placeholder:"Buscar por título, autor o palabra clave"},null,8,["modelValue"]),e("div",fe,[e("div",ye,[(r(!0),a(d,null,p(D.value,t=>(r(),a("button",{key:t,type:"button",class:J(["filter-chip",{"is-active":_.value===t}]),onClick:u=>_.value=t},l(t),11,he))),128))]),e("div",be,[(r(),a(d,null,p(R,t=>e("button",{key:t,type:"button",class:J(["filter-pill",{"is-active":w.value===t}]),onClick:u=>w.value=t},l(t),11,ge)),64))]),e("label",ke,[s[13]||(s[13]=e("span",null,"Ordenar por",-1)),T(e("select",{"onUpdate:modelValue":s[1]||(s[1]=t=>N.value=t)},[...s[12]||(s[12]=[e("option",{value:"recent"},"Más recientes",-1),e("option",{value:"active"},"Más activos",-1)])],512),[[I,N.value]])])]),e("p",Ce,l(B(m).loading?"Cargando conversaciones…":`${A.value.length} hilos activos listos para feedback.`),1),B(m).error?(r(),a("p",Se,l(B(m).error),1)):h("",!0)]),e("div",Te,[e("div",Me,[B(m).loading?(r(),a("article",we,"Cargando conversaciones…")):A.value.length?h("",!0):(r(),a("article",Ve," No encontramos hilos con esos filtros todavía. ")),(r(!0),a(d,null,p(A.value,t=>{var u,v;return r(),a("article",{key:t.id,class:"thread-card"},[e("header",xe,[e("div",null,[e("span",Ee,l(t.category),1),e("span",Ae,l(t.status),1)]),e("span",null,l(t.lastActivity),1)]),e("h3",null,l(t.title),1),e("p",null,l(t.preview||"Explora el último update del equipo y deja feedback."),1),(u=t.focus)!=null&&u.length?(r(),a("ul",Be,[(r(!0),a(d,null,p(t.focus,c=>(r(),a("li",{key:c},l(c),1))),128))])):h("",!0),e("div",Ne,[e("span",null,"Por "+l(t.author),1),e("span",null,l(t.replies)+" respuestas",1)]),e("div",Ue,[s[15]||(s[15]=e("p",{class:"comments__title"},"Comentarios rápidos",-1)),(v=t.comments)!=null&&v.length?(r(),a("div",De,[(r(!0),a(d,null,p(t.comments,c=>(r(),a("article",{key:c.id,class:"comment"},[e("strong",null,l(c.author),1),e("p",null,l(c.content),1),e("small",null,l(c.date),1)]))),128))])):(r(),a("p",Fe,"Sé la primera persona en responder.")),e("form",{class:"comment-form",onSubmit:H(c=>oe(t.id),["prevent"])},[T(e("input",{"onUpdate:modelValue":c=>x.value[t.id]=c,type:"text",placeholder:"Aporta una idea en una línea","aria-label":"Nuevo comentario"},null,8,qe),[[O,x.value[t.id]]]),S(q,{variant:"secondary",size:"sm",type:"submit"},{default:L(()=>[...s[14]||(s[14]=[j("Comentar",-1)])]),_:1})],40,Le)])])}),128))]),e("aside",Oe,[k.value?(r(),a("article",je,[s[16]||(s[16]=e("p",{class:"section-kicker"},"Hilo destacado",-1)),e("h4",null,l(k.value.title),1),e("p",null,l(k.value.preview),1),e("ul",Re,[(r(!0),a(d,null,p(k.value.focus,t=>(r(),a("li",{key:t},l(t),1))),128))]),e("button",{type:"button",onClick:s[2]||(s[2]=t=>_.value=k.value.category)},"Ver hilos similares")])):h("",!0),e("article",$e,[s[17]||(s[17]=e("p",{class:"section-kicker"},"Rituales",-1)),s[18]||(s[18]=e("h4",null,"Sesiones sugeridas",-1)),e("ul",null,[(r(),a(d,null,p(W,t=>e("li",{key:t.day},[e("strong",null,l(t.day),1),e("span",null,l(t.title),1)])),64))])]),e("article",ze,[s[19]||(s[19]=e("p",{class:"section-kicker"},"Snippets",-1)),s[20]||(s[20]=e("h4",null,"Prompts destacados",-1)),(r(),a(d,null,p(K,t=>e("div",{class:"snippet",key:t},[e("code",null,l(t),1)])),64))])])]),U.value?(r(),a("div",Ge,[e("div",Pe,[e("header",null,[s[21]||(s[21]=e("div",null,[e("p",{class:"section-kicker"},"Nuevo hilo"),e("h3",null,"Comparte contexto y adjunta recursos.")],-1)),e("button",{type:"button","aria-label":"Cerrar",onClick:$},"×")]),e("form",{onSubmit:H(se,["prevent"])},[S(Q,{modelValue:n.title,"onUpdate:modelValue":s[3]||(s[3]=t=>n.title=t),label:"Título",placeholder:"Ej. Necesito feedback en mi case study"},null,8,["modelValue"]),e("label",Ie,[s[22]||(s[22]=e("span",null,"Categoría",-1)),T(e("select",{"onUpdate:modelValue":s[4]||(s[4]=t=>n.category=t)},[(r(!0),a(d,null,p(E.value,t=>(r(),a("option",{key:t,value:t},l(t),9,He))),128))],512),[[I,n.category]])]),e("label",Je,[s[23]||(s[23]=e("span",null,"Contexto",-1)),T(e("textarea",{"onUpdate:modelValue":s[5]||(s[5]=t=>n.content=t),rows:"5",placeholder:"Describe el reto, qué feedback buscas y qué entregables adjuntas"},null,512),[[O,n.content]])]),e("label",Qe,[s[24]||(s[24]=e("span",null,"Tags rápidos",-1)),T(e("input",{"onUpdate:modelValue":s[6]||(s[6]=t=>n.focus=t),type:"text",placeholder:"Ej. Storytelling, Métricas"},null,512),[[O,n.focus]])]),i.error?(r(),a("p",Xe,l(i.error),1)):h("",!0),S(q,{type:"submit",disabled:i.isSubmitting},{default:L(()=>[j(l(i.isSubmitting?"Publicando…":"Publicar hilo"),1)]),_:1},8,["disabled"])],32)])])):h("",!0)]))}},tt=le(Ke,[["__scopeId","data-v-aace874a"]]);export{tt as default};
