import{_ as V,p as x,s as N,c as p,o as I,x as $,a as d,b as e,d as v,w as r,B as y,f as C,u as D,g as o,h as u,m as b,F as L,e as J,n as h,t as n,i as M,l as R}from"./index-Cw7ty9o7.js";import{B as m}from"./BaseCard-B_bAREMe.js";import{u as T}from"./jobsStore-MtEZzHB6.js";const U={class:"applicants"},F={class:"applicants__header"},q={class:"applicants__layout"},H={class:"panel-table"},O=["onClick"],P=["onClick"],G={key:1},K={key:0},Q={colspan:"6",class:"empty-cell"},W={class:"detail-block"},X={class:"detail-value"},Y={key:0,class:"detail-block"},Z={class:"detail-value"},ee={class:"detail-block"},te={class:"detail-value"},se={class:"detail-block"},ae={class:"detail-value"},le={key:1},ne={class:"detail-block"},oe={class:"detail-value"},ie={key:1,class:"detail-block"},de={class:"detail-value"},re={class:"detail-block"},ue={class:"detail-actions"},ce={__name:"Applicants",setup(pe){const i=T(),_=x(),g=D(),a=N(null),f=p(()=>{var s,t,l;return((t=(s=_.user)==null?void 0:s.company)==null?void 0:t._id)||((l=_.user)==null?void 0:l.company)}),j=p(()=>i.jobs.length?f.value?new Set(i.jobs.filter(s=>s.companyId===f.value).map(s=>s.id)):new Set(i.jobs.map(s=>s.id)):new Set),c=p(()=>{const s=j.value;return s.size?i.applications.filter(t=>s.has(t.jobId)):i.applications}),w=s=>{a.value=s},z=s=>s?s.toLowerCase().normalize("NFD").replace(/[^a-z0-9]+/g,"-"):"",k=s=>{s&&window.open(s,"_blank","noopener")},A=s=>{s&&(window.location.href=`mailto:${s}`)},S=s=>{s&&g.push({name:"job-detail",params:{id:s}})},B=async()=>{await i.fetchApplications()};return I(async()=>{i.jobs.length||await i.fetchJobs(),i.applications.length||await i.fetchApplications(),a.value=c.value[0]||null}),$(c,s=>{if(!s.length){a.value=null;return}(!a.value||!s.some(t=>t.id===a.value.id))&&(a.value=s[0])}),(s,t)=>(o(),d("section",U,[e("header",F,[t[4]||(t[4]=e("div",null,[e("p",{class:"section-kicker"},"Talent pipeline"),e("h1",null,"Revisa perfiles y prioriza entrevistas."),e("p",null,"Tu panel organiza aplicaciones, estatus y notas clave para decidir más rápido.")],-1)),v(y,{size:"sm",variant:"ghost",onClick:B},{default:r(()=>[...t[3]||(t[3]=[u("Actualizar",-1)])]),_:1})]),e("div",q,[v(m,{class:"applicants__table"},{title:r(()=>[...t[5]||(t[5]=[u("Postulaciones",-1)])]),default:r(()=>[e("table",H,[t[6]||(t[6]=e("thead",null,[e("tr",null,[e("th",null,"Candidato"),e("th",null,"Rol"),e("th",null,"Empresa"),e("th",null,"Mensaje"),e("th",null,"CV"),e("th",null,"Estatus")])],-1)),e("tbody",null,[(o(!0),d(L,null,J(c.value,l=>(o(),d("tr",{key:l.id,onClick:E=>w(l),class:h({active:a.value&&a.value.id===l.id})},[e("td",null,n(l.candidate),1),e("td",null,n(l.role),1),e("td",null,n(l.jobCompany||"Confidencial"),1),e("td",null,n(l.message||"Sin mensaje"),1),e("td",null,[l.cvUrl?(o(),d("button",{key:0,class:"table-link",type:"button",onClick:M(E=>k(l.cvUrl),["stop"])}," Descargar ",8,P)):(o(),d("span",G,"—"))]),e("td",null,[e("span",{class:h(["status-chip",z(l.statusLabel)])},n(l.statusLabel),3)])],10,O))),128)),c.value.length?b("",!0):(o(),d("tr",K,[e("td",Q,n(R(i).loading?"Cargando postulaciones…":"Aún no hay postulaciones para tus vacantes."),1)]))])])]),_:1}),a.value?(o(),C(m,{key:0,class:"applicants__details"},{title:r(()=>[u(n(a.value.candidate),1)]),default:r(()=>[e("div",W,[t[7]||(t[7]=e("p",{class:"detail-label"},"Rol",-1)),e("p",X,n(a.value.role),1)]),a.value.candidateEmail?(o(),d("div",Y,[t[8]||(t[8]=e("p",{class:"detail-label"},"Correo",-1)),e("p",Z,n(a.value.candidateEmail),1)])):b("",!0),e("div",ee,[t[9]||(t[9]=e("p",{class:"detail-label"},"Mensaje enviado",-1)),e("p",te,n(a.value.message||"No se incluyó mensaje adicional."),1)]),e("div",se,[t[10]||(t[10]=e("p",{class:"detail-label"},"CV adjunto",-1)),e("p",ae,[a.value.cvUrl?(o(),d("button",{key:0,class:"table-link",type:"button",onClick:t[0]||(t[0]=l=>k(a.value.cvUrl))},n(a.value.cvOriginalName||"Descargar CV"),1)):(o(),d("span",le,"Sin archivo"))])]),e("div",ne,[t[11]||(t[11]=e("p",{class:"detail-label"},"Estado",-1)),e("p",oe,n(a.value.statusLabel),1)]),a.value.jobCompany?(o(),d("div",ie,[t[12]||(t[12]=e("p",{class:"detail-label"},"Empresa",-1)),e("p",de,n(a.value.jobCompany),1)])):b("",!0),e("div",re,[t[14]||(t[14]=e("p",{class:"detail-label"},"Acciones",-1)),e("div",ue,[v(y,{size:"sm",variant:"ghost",onClick:t[1]||(t[1]=l=>A(a.value.candidateEmail))},{default:r(()=>[...t[13]||(t[13]=[u(" Contactar ",-1)])]),_:1}),e("button",{class:"table-link",type:"button",onClick:t[2]||(t[2]=l=>S(a.value.jobId))},"Ver vacante")])])]),_:1})):(o(),C(m,{key:1,class:"applicants__details"},{title:r(()=>[...t[15]||(t[15]=[u("Selecciona un perfil",-1)])]),default:r(()=>[t[16]||(t[16]=e("p",null,"Haz clic en cualquier fila para revisar el contexto y enlazar a su portafolio.",-1))]),_:1}))])]))}},_e=V(ce,[["__scopeId","data-v-77a94839"]]);export{_e as default};
